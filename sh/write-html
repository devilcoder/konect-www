#! /bin/sh
#
# Generate the full HTML page from a skeleton.
#
# PARAMETERS
#	$name
#
# INPUT FILES
#	skeleton/$name.html
#	static/(head foot).html 
#

set -e 

title=$(<skeleton/"$name".html sed -E -e 's|^.*<H1>(.*)</H1>.*$|\1|;t;d')

if [ -z "$title" ] ; then
	echo >&2 "*** Expected a title, but found none"
	exit 1
fi

mkdir -p "$(dirname www/"$name".html)"
{
	<static/head.html sed -E -e 's,\$\{title\},'"$title"','
	cat skeleton/"$name".html
	cat static/foot.html
} >www/"$name".html
